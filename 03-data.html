<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-CA" xml:lang="en-CA"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Julien Martin">
<meta name="description" content="Early version needed to be severely updated/modified">
<title>3&nbsp; Data – On the R-way to hell</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-graphics_short.html" rel="next">
<link href="./02-basics.html" rel="prev">
<link href="./images/cover/book_fav.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-79bb3942e891885f9f7af119cd221462.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-37bb72f48501692975d9c066fdeb097b.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1ff0208b9405ab0ff3a2d5e39eb7a7a0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SLXFYRXJR4"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SLXFYRXJR4', { 'anonymize_ip': true});
</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><img src="images/cover/book_hex_en.png" class="img-fluid" width="50"> R Way</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-flag" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-flag" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-flag">
<li>
    <a class="dropdown-item" href="https://biostats-uottawa.github.io/enfR/03-donnees.html">
 <span class="dropdown-text">Français</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link active" href="./902-data.html" aria-current="page"> 
<span class="menu-text">Data &amp; Code</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/"> 
<span class="menu-text">Biostats uOttawa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bioXx58/"> 
<span class="menu-text">Intro Biostats &amp; R (BioXx58)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://biostats-uottawa.github.io/bio8940/"> 
<span class="menu-text">Advanced Biostats (Bio8940)</span></a>
  </li>  
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">auto</span>
    </span>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/biostats-uottawa/Rway/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./On-the-R-way-to-hell.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./On-the-R-way-to-hell.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-start.html">Using R</a></li><li class="breadcrumb-item"><a href="./03-data.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Using R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Some R basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-graphics_short.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Figures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible reports with Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Version control with Git and GitHub</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentals of stats</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-reg_lin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlation and simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two - sample comparisons</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-anova_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiway ANOVA: factorial and nested designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35-reg_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36-ancova_glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ANCOVA and general linear model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Generalized linear models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./41-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Generalized linear model, <code>glm</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./42-model_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Frequency data and Poisson Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Mixed models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./51-lmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to linear mixed models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./52-intro_glmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to <code>GLMM</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./53-randreg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random regression and character state approaches</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./54-multivar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multivariate mixed models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Generalized additive models</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Multivariate analysis</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Bayesian approach</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./81-beyond_p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Beyond *P </span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./82-intro_bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Introduction to Bayesian Inference</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./901-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./902-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Data used in this book</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./903-latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Installing Quarto and LateX</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#data-types" id="toc-data-types" class="nav-link active" data-scroll-target="#data-types"><span class="header-section-number">3.1</span> Data types</a></li>
  <li>
<a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures"><span class="header-section-number">3.2</span> Data structures</a>
  <ul class="collapse">
<li><a href="#sec-scal-vecs" id="toc-sec-scal-vecs" class="nav-link" data-scroll-target="#sec-scal-vecs"><span class="header-section-number">3.2.1</span> Scalars and vectors</a></li>
  <li><a href="#sec-mat-array" id="toc-sec-mat-array" class="nav-link" data-scroll-target="#sec-mat-array"><span class="header-section-number">3.2.2</span> Matrices and arrays</a></li>
  <li><a href="#sec-lists" id="toc-sec-lists" class="nav-link" data-scroll-target="#sec-lists"><span class="header-section-number">3.2.3</span> Lists</a></li>
  <li><a href="#sec-df" id="toc-sec-df" class="nav-link" data-scroll-target="#sec-df"><span class="header-section-number">3.2.4</span> Data frames</a></li>
  </ul>
</li>
  <li>
<a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data"><span class="header-section-number">3.3</span> Importing data</a>
  <ul class="collapse">
<li><a href="#saving-files-to-import" id="toc-saving-files-to-import" class="nav-link" data-scroll-target="#saving-files-to-import"><span class="header-section-number">3.3.1</span> Saving files to import</a></li>
  <li><a href="#sec-import-fnc" id="toc-sec-import-fnc" class="nav-link" data-scroll-target="#sec-import-fnc"><span class="header-section-number">3.3.2</span> Import functions</a></li>
  <li><a href="#common-import-frustrations" id="toc-common-import-frustrations" class="nav-link" data-scroll-target="#common-import-frustrations"><span class="header-section-number">3.3.3</span> Common import frustrations</a></li>
  <li><a href="#sec-import-other" id="toc-sec-import-other" class="nav-link" data-scroll-target="#sec-import-other"><span class="header-section-number">3.3.4</span> Other import options</a></li>
  </ul>
</li>
  <li>
<a href="#wrangling-data-frames" id="toc-wrangling-data-frames" class="nav-link" data-scroll-target="#wrangling-data-frames"><span class="header-section-number">3.4</span> Wrangling data frames</a>
  <ul class="collapse">
<li><a href="#positional-indexes" id="toc-positional-indexes" class="nav-link" data-scroll-target="#positional-indexes"><span class="header-section-number">3.4.1</span> Positional indexes</a></li>
  <li><a href="#logical-indexes" id="toc-logical-indexes" class="nav-link" data-scroll-target="#logical-indexes"><span class="header-section-number">3.4.2</span> Logical indexes</a></li>
  <li><a href="#ordering-data-frames" id="toc-ordering-data-frames" class="nav-link" data-scroll-target="#ordering-data-frames"><span class="header-section-number">3.4.3</span> Ordering data frames</a></li>
  <li><a href="#adding-columns-and-rows" id="toc-adding-columns-and-rows" class="nav-link" data-scroll-target="#adding-columns-and-rows"><span class="header-section-number">3.4.4</span> Adding columns and rows</a></li>
  <li><a href="#merging-data-frames" id="toc-merging-data-frames" class="nav-link" data-scroll-target="#merging-data-frames"><span class="header-section-number">3.4.5</span> Merging data frames</a></li>
  <li><a href="#sec-reshape" id="toc-sec-reshape" class="nav-link" data-scroll-target="#sec-reshape"><span class="header-section-number">3.4.6</span> Reshaping data frames</a></li>
  </ul>
</li>
  <li><a href="#introduction-to-the-tidyverse" id="toc-introduction-to-the-tidyverse" class="nav-link" data-scroll-target="#introduction-to-the-tidyverse"><span class="header-section-number">3.5</span> Introduction to the <code>tidyverse</code></a></li>
  <li><a href="#summarising-data-frames" id="toc-summarising-data-frames" class="nav-link" data-scroll-target="#summarising-data-frames"><span class="header-section-number">3.6</span> Summarising data frames</a></li>
  <li>
<a href="#exporting-data" id="toc-exporting-data" class="nav-link" data-scroll-target="#exporting-data"><span class="header-section-number">3.7</span> Exporting data</a>
  <ul class="collapse">
<li><a href="#export-functions" id="toc-export-functions" class="nav-link" data-scroll-target="#export-functions"><span class="header-section-number">3.7.1</span> Export functions</a></li>
  <li><a href="#other-export-functions" id="toc-other-export-functions" class="nav-link" data-scroll-target="#other-export-functions"><span class="header-section-number">3.7.2</span> Other export functions</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/biostats-uottawa/Rway/edit/main/03-data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostats-uottawa/Rway/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-start.html">Using R</a></li><li class="breadcrumb-item"><a href="./03-data.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-data-r" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Until now, you’ve created fairly simple data in R and stored it as a vector (<a href="02-basics.html#sec-funcs" class="quarto-xref"><span>Section 2.4</span></a>). However, most (if not all) of you will have much more complicated datasets from your various experiments and surveys that go well beyond what a vector can handle. Learning how R deals with different types of data and data structures, how to import your data into R and how to manipulate and summarize your data are some of the most important skills you will need to master.</p>
<p>In this Chapter we’ll go over the main data types in R and focus on some of the most common data structures. We will also cover how to import data into R from an external file, how to manipulate (wrangle) and summarize data and finally how to export data from R to an external file.</p>
<section id="data-types" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="data-types">
<span class="header-section-number">3.1</span> Data types</h2>
<p>Understanding the different types of data and how R deals with these data is important. The temptation is to glaze over and skip these technical details, but beware, this can come back to bite you somewhere unpleasant if you don’t pay attention. We’ve already seen an example (<a href="02-basics.html#sec-r-objs" class="quarto-xref"><span>Section 2.3.1</span></a>) of this when we tried (and failed) to add two character objects together using the <code>+</code> operator.</p>
<p>R has six basic types of data; numeric, integer, logical, complex and character. The keen eyed among you will notice we’ve only listed five data types here, the final data type is raw which we won’t cover as it’s not useful 99.99% of the time. We also won’t cover complex numbers, but will let you <a href="https://www.mathsisfun.com/numbers/complex-numbers.html">imagine</a> that part!</p>
<ul>
<li><p><strong>Numeric</strong> data are numbers that contain a decimal. Actually they can also be whole numbers but we’ll gloss over that.</p></li>
<li><p><strong>Integers</strong> are whole numbers (those numbers without a decimal point).</p></li>
<li><p><strong>Logical</strong> data take on the value of either <code>TRUE</code> or <code>FALSE</code>. There’s also another special type of logical called <code>NA</code> to represent missing values.</p></li>
<li><p><strong>Character</strong> data are used to represent string values. You can think of character strings as something like a word (or multiple words). A special type of character string is a <em>factor</em>, which is a string but with additional attributes (like levels or an order). We’ll cover factors later.</p></li>
</ul>
<p>R is (usually) able to automatically distinguish between different classes of data by their nature and the context in which they’re used although you should bear in mind that R can’t actually read your mind and you may have to explicitly tell R how you want to care a data type. You can find out the type (or class) of any object using the <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fl">2.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">char</span> <span class="op">&lt;-</span> <span class="st">"hello"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">logi</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">logi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<p>Alternatively, you can ask if an object is a specific class using using a logical test. The <code>is.[classOfData]()</code> family of functions will return either a <code>TRUE</code> or a <code>FALSE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/logical.html">is.logical</a></span><span class="op">(</span><span class="va">logi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>It can sometimes be useful to be able to change the class of a variable using the <code>as.[className]()</code> family of coercion functions, although you need to be careful when doing this as you might receive some unexpected results (see what happens below when we try to convert a character string to a numeric).</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># coerce numeric to character</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">num_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span></span>
<span><span class="va">num_char</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2.2"</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">num_char</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># coerce character to numeric!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">char_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">char</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
</div>
<p>Here’s a summary table of some of the logical test and coercion functions available to you.</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Type</th>
<th style="text-align: center;">Logical test</th>
<th style="text-align: center;">Coercing</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Character</td>
<td style="text-align: center;"><code>is.character</code></td>
<td style="text-align: center;"><code>as.character</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">Numeric</td>
<td style="text-align: center;"><code>is.numeric</code></td>
<td style="text-align: center;"><code>as.numeric</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Logical</td>
<td style="text-align: center;"><code>is.logical</code></td>
<td style="text-align: center;"><code>as.logical</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">Factor</td>
<td style="text-align: center;"><code>is.factor</code></td>
<td style="text-align: center;"><code>as.factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Complex</td>
<td style="text-align: center;"><code>is.complex</code></td>
<td style="text-align: center;"><code>as.complex</code></td>
</tr>
</tbody>
</table></section><section id="data-structures" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="data-structures">
<span class="header-section-number">3.2</span> Data structures</h2>
<p>Now that you’ve been introduced to some of the most important classes of data in R, let’s have a look at some of main structures that we have for storing these data.</p>
<section id="sec-scal-vecs" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-scal-vecs">
<span class="header-section-number">3.2.1</span> Scalars and vectors</h3>
<p>Perhaps the simplest type of data structure is the vector. You’ve already been introduced to vectors in <a href="02-basics.html#sec-funcs" class="quarto-xref"><span>Section 2.4</span></a> although some of the vectors you created only contained a single value. Vectors that have a single value (length 1) are called scalars. Vectors can contain numbers, characters, factors or logicals, but the key thing to remember is that all the elements inside a vector must be of the same class. In other words, vectors can contain either numbers, characters or logical but not mixtures of these types of data. There is one important exception to this, you can include <code>NA</code> (remember this is special type of logical) to denote missing data in vectors with other data types.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-data_struc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-data_struc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/data/scal_vec.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data_struc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Scalar and vector data structure
</figcaption></figure>
</div>
</div>
</div>
</section><section id="sec-mat-array" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="sec-mat-array">
<span class="header-section-number">3.2.2</span> Matrices and arrays</h3>
<p>Another useful data structure used in many disciplines such as population ecology, theoretical and applied statistics is the matrix. A matrix is simply a vector that has additional attributes called dimensions. Arrays are just multidimensional matrices. Again, matrices and arrays must contain elements all of the same data class.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-data_struc2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-data_struc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/data/mat_array.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data_struc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Matrix and array data structure
</figcaption></figure>
</div>
</div>
</div>
<p>A convenient way to create a matrix or an array is to use the <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> and <code><a href="https://rdrr.io/r/base/array.html">array()</a></code> functions respectively. Below, we will create a matrix from a sequence 1 to 16 in four rows (<code>nrow = 4</code>) and fill the matrix row-wise (<code>byrow = TRUE</code>) rather than the default column-wise. When using the <code><a href="https://rdrr.io/r/base/array.html">array()</a></code> function we define the dimensions using the <code>dim =</code> argument, in our case 2 rows, 4 columns in 2 different matrices.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">my_mat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
[3,]    9   10   11   12
[4,]   13   14   15   16</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1

     [,1] [,2] [,3] [,4]
[1,]    1    3    5    7
[2,]    2    4    6    8

, , 2

     [,1] [,2] [,3] [,4]
[1,]    9   11   13   15
[2,]   10   12   14   16</code></pre>
</div>
</div>
<p>Sometimes it’s also useful to define row and column names for your matrix but this is not a requirement. To do this use the <code><a href="https://rdrr.io/r/base/colnames.html">rownames()</a></code> and <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code> functions.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">my_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">my_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span>
<span><span class="va">my_mat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   a  b  c  d
A  1  2  3  4
B  5  6  7  8
C  9 10 11 12
D 13 14 15 16</code></pre>
</div>
</div>
<p>Once you’ve created your matrices you can do useful stuff with them and as you’d expect, R has numerous built in functions to perform matrix operations. Some of the most common are given below. For example, to transpose a matrix we use the transposition function <code><a href="https://rdrr.io/r/base/t.html">t()</a></code></p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mat_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">my_mat</span><span class="op">)</span></span>
<span><span class="va">my_mat_t</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B  C  D
a 1 5  9 13
b 2 6 10 14
c 3 7 11 15
d 4 8 12 16</code></pre>
</div>
</div>
<p>To extract the diagonal elements of a matrix and store them as a vector we can use the <code><a href="https://rdrr.io/r/base/diag.html">diag()</a></code> function</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_mat_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">my_mat</span><span class="op">)</span></span>
<span><span class="va">my_mat_diag</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  6 11 16</code></pre>
</div>
</div>
<p>The usual matrix addition, multiplication etc can be performed. Note the use of the <code>%*%</code> operator to perform matrix multiplication.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># notice that the matrix has been filled</span></span>
<span><span class="va">mat.1</span> <span class="co"># column-wise by default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    1
[2,]    0    1</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mat.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    0
[2,]    1    2</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat.1</span> <span class="op">+</span> <span class="va">mat.2</span> <span class="co"># matrix addition</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    3    1
[2,]    1    3</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat.1</span> <span class="op">*</span> <span class="va">mat.2</span> <span class="co"># element by element products</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    0
[2,]    0    2</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mat.1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">mat.2</span> <span class="co"># matrix multiplication</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    3    2
[2,]    1    2</code></pre>
</div>
</div>
</section><section id="sec-lists" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-lists">
<span class="header-section-number">3.2.3</span> Lists</h3>
<p>The next data structure we will quickly take a look at is a list. Whilst vectors and matrices are constrained to contain data of the same type, lists are able to store mixtures of data types. In fact we can even store other data structures such as vectors and arrays within a list or even have a list of a list. This makes for a very flexible data structure which is ideal for storing irregular or non-rectangular data (see <a href="05-programming.html" class="quarto-xref"><span>Chapter 5</span></a> for an example).</p>
<p>To create a list we can use the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> function. Note how each of the three list elements are of different classes (character, logical, and numeric) and are of different lengths.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"yellow"</span>, <span class="st">"orange"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">list_1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "black"  "yellow" "orange"

[[2]]
[1]  TRUE  TRUE FALSE  TRUE FALSE FALSE

[[3]]
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
</div>
</div>
<p>Elements of the list can be named during the construction of the list</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"yellow"</span>, <span class="st">"orange"</span><span class="op">)</span>,</span>
<span>  evaluation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">list_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$colours
[1] "black"  "yellow" "orange"

$evaluation
[1]  TRUE  TRUE FALSE  TRUE FALSE FALSE

$time
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
</div>
</div>
<p>or after the list has been created using the <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> function</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">list_1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"colours"</span>, <span class="st">"evaluation"</span>, <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="va">list_1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$colours
[1] "black"  "yellow" "orange"

$evaluation
[1]  TRUE  TRUE FALSE  TRUE FALSE FALSE

$time
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
</div>
</div>
</section><section id="sec-df" class="level3" data-number="3.2.4"><h3 data-number="3.2.4" class="anchored" data-anchor-id="sec-df">
<span class="header-section-number">3.2.4</span> Data frames</h3>
<p>By far the most commonly used data structure to store data in is the data frame. A data frame is a powerful two-dimensional object made up of rows and columns which looks superficially very similar to a matrix. However, whilst matrices are restricted to containing data all of the same type, data frames can contain a mixture of different types of data. Typically, in a data frame each row corresponds to an individual observation and each column corresponds to a different measured or recorded variable. This setup may be familiar to those of you who use LibreOffice Calc or Microsoft Excel to manage and store your data. Perhaps a useful way to think about data frames is that they are essentially made up of a bunch of vectors (columns) with each vector containing its own data type but the data type can be different between vectors.</p>
<p>As an example, the data frame below contains the results of an experiment to determine the effect of parental care (with or without) of unicorns (<em>Unicornus magnificens</em>) on offsprings growth under 3 different food availability regime. The data frame has 8 variables (columns) and each row represents an individual unicorn. The variables <code>care</code> and <code>food</code> are factors (<a href="https://en.wikipedia.org/wiki/Categorical_variable">categorical</a> variables). The <code>p_care</code> variable has 2 levels (<code>care</code> and <code>no_care</code>) and the <code>food</code> level variable has 3 levels (<code>low</code>, <code>medium</code> and <code>high</code>). The variables <code>height</code>, <code>weight</code>, <code>mane_size</code> and <code>fluffyness</code> are numeric and the variable <code>horn_rings</code> is an integer representing the number of rings on the horn. Although the variable <code>block</code> has numeric values, these do not really have any order and could also be treated as a factor (i.e. they could also have been called A and B).</p>
<div class="cell">
<div id="tbl-import-data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-import-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Imported unicorn data
</figcaption><div aria-describedby="tbl-import-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">p_care</th>
<th style="text-align: left;">food</th>
<th style="text-align: right;">block</th>
<th style="text-align: right;">height</th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">mane_size</th>
<th style="text-align: right;">fluffyness</th>
<th style="text-align: right;">horn_rings</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">7.62</td>
<td style="text-align: right;">11.7</td>
<td style="text-align: right;">31.9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">12.14</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">46.0</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.2</td>
<td style="text-align: right;">12.76</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">66.7</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">8.78</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">20.3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10.4</td>
<td style="text-align: right;">13.58</td>
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">26.9</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">care</td>
<td style="text-align: left;">medium</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9.8</td>
<td style="text-align: right;">10.08</td>
<td style="text-align: right;">12.2</td>
<td style="text-align: right;">72.7</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">8.10</td>
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">60.5</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">7.45</td>
<td style="text-align: right;">14.1</td>
<td style="text-align: right;">38.1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">9.19</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">52.6</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">8.92</td>
<td style="text-align: right;">11.6</td>
<td style="text-align: right;">55.2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">8.44</td>
<td style="text-align: right;">13.5</td>
<td style="text-align: right;">77.6</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">no_care</td>
<td style="text-align: left;">low</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">10.60</td>
<td style="text-align: right;">16.2</td>
<td style="text-align: right;">63.3</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>There are a couple of important things to bear in mind about data frames. These types of objects are known as rectangular data (or tidy data) as each column must have the same number of observations. Also, any missing data should be recorded as an <code>NA</code> just as we did with our vectors.</p>
<p>We can construct a data frame from existing data objects such as vectors using the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function. As an example, let’s create three vectors <code>p.height</code>, <code>p.weight</code> and <code>p.names</code> and include all of these vectors in a data frame object called <code>dataf</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p.height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">155</span>, <span class="fl">160</span>, <span class="fl">167</span>, <span class="fl">181</span><span class="op">)</span></span>
<span><span class="va">p.weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">50</span>, <span class="fl">52</span>, <span class="fl">58</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">p.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Joanna"</span>, <span class="st">"Charlotte"</span>, <span class="st">"Helen"</span>, <span class="st">"Karen"</span>, <span class="st">"Amy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>height <span class="op">=</span> <span class="va">p.height</span>, weight <span class="op">=</span> <span class="va">p.weight</span>, names <span class="op">=</span> <span class="va">p.names</span><span class="op">)</span></span>
<span><span class="va">dataf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  height weight     names
1    180     65    Joanna
2    155     50 Charlotte
3    160     52     Helen
4    167     58     Karen
5    181     70       Amy</code></pre>
</div>
</div>
<p>You’ll notice that each of the columns are named with variable name we supplied when we used the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function. It also looks like the first column of the data frame is a series of numbers from one to five. Actually, this is not really a column but the name of each row. We can check this out by getting R to return the dimensions of the <code>dataf</code> object using the <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> function. We see that there are 5 rows and 3 columns.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dataf</span><span class="op">)</span> <span class="co"># 5 rows and 3 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 3</code></pre>
</div>
</div>
<p>Another really useful function which we use all the time is <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> which will return a compact summary of the structure of the data frame object (or any object for that matter).</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dataf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5 obs. of  3 variables:
 $ height: num  180 155 160 167 181
 $ weight: num  65 50 52 58 70
 $ names : chr  "Joanna" "Charlotte" "Helen" "Karen" ...</code></pre>
</div>
</div>
<p>The <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function gives us the data frame dimensions and also reminds us that <code>dataf</code> is a <code>data.frame</code> type object. It also lists all of the variables (columns) contained in the data frame, tells us what type of data the variables contain and prints out the first five values. We often copy this summary and place it in our R scripts with comments at the beginning of each line so we can easily refer back to it whilst writing our code. We showed you how to comment blocks in RStudio <a href="01-start.html#sec-proj-doc" class="quarto-xref"><span>Section 1.7</span></a>.</p>
<p>Also notice that R has automatically decided that our <code>p.names</code> variable should be a character (<code>chr</code>) class variable when we first created the data frame. Whether this is a good idea or not will depend on how you want to use this variable in later analysis. If we decide that this wasn’t such a good idea we can change the default behaviour of the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function by including the argument <code>stringsAsFactors = TRUE</code>. Now our strings are automatically converted to factors.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p.height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">180</span>, <span class="fl">155</span>, <span class="fl">160</span>, <span class="fl">167</span>, <span class="fl">181</span><span class="op">)</span></span>
<span><span class="va">p.weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">50</span>, <span class="fl">52</span>, <span class="fl">58</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">p.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Joanna"</span>, <span class="st">"Charlotte"</span>, <span class="st">"Helen"</span>, <span class="st">"Karen"</span>, <span class="st">"Amy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  height <span class="op">=</span> <span class="va">p.height</span>, weight <span class="op">=</span> <span class="va">p.weight</span>, names <span class="op">=</span> <span class="va">p.names</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dataf</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5 obs. of  3 variables:
 $ height: num  180 155 160 167 181
 $ weight: num  65 50 52 58 70
 $ names : Factor w/ 5 levels "Amy","Charlotte",..: 4 2 3 5 1</code></pre>
</div>
</div>
</section></section><section id="importing-data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="importing-data">
<span class="header-section-number">3.3</span> Importing data</h2>
<p>Although creating data frames from existing data structures is extremely useful, by far the most common approach is to create a data frame by importing data from an external file. To do this, you’ll need to have your data correctly formatted and saved in a file format that R is able to recognize. Fortunately for us, R is able to recognize a wide variety of file formats, although in reality you’ll probably end up only using two or three regularly.</p>
<section id="saving-files-to-import" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="saving-files-to-import">
<span class="header-section-number">3.3.1</span> Saving files to import</h3>
<p>The easiest method of creating a data file to import into R is to enter your data into a spreadsheet using either Microsoft Excel or LibreOffice Calc and save the spreadsheet as a comma delimited file. We prefer LibreOffice Calc as it’s open source, platform independent and free but MS Excel is OK too (but see <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7">here</a> for some gotchas). Here’s the data from the petunia experiment we discussed previously displayed in LibreOffice. If you want to follow along you can download the data file (<em>‘unicorn.xlsx’</em>) from <a href="902-data.html" class="quarto-xref"><span>Appendix A</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-LO-calc0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-LO-calc0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/data/libre_off.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LO-calc0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Unicorn data in LibreOffice Calc
</figcaption></figure>
</div>
</div>
</div>
<p>For those of you unfamiliar with the tab delimited file format it simply means that data in different columns are separated with a ‘,’ character and is usually saved as a file with a ‘.csv’ extension.</p>
<p>To save a spreadsheet as a comma delimited file in LibreOffice Calc select <code>File</code> -&gt; <code>Save as ...</code> from the main menu. You will need to specify the location you want to save your file in the ‘Save in folder’ option and the name of the file in the ‘Name’ option. In the drop down menu located above the ‘Save’ button change the default ‘All formats’ to ‘Text CSV (.csv)’.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-LO-calc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-LO-calc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/data/libre_off1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LO-calc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Choosing <code>csv</code> format when saving with LibreOffice Calc
</figcaption></figure>
</div>
</div>
</div>
<p>Click the Save button and then select the ‘Use Text CSV Format’ option. Click on OK to save the file.</p>
<p>There are a couple of things to bear in mind when saving files to import into R which will make your life easier in the long run. Keep your column headings (if you have them) short and informative. Also avoid spaces in your column headings by replacing them with an underscore or a dot (i.e. replace <code>mane size</code> with <code>mane size</code> or <code>mane.size</code>) and avoid using special characters (i.e. <code>leaf area (mm^2)</code> or uppercase to simpy your life). Remember, if you have missing data in your data frame (empty cells) you should use an <code>NA</code> to represent these missing values or have an empty cell. This will keep the data frame tidy.</p>
</section><section id="sec-import-fnc" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="sec-import-fnc">
<span class="header-section-number">3.3.2</span> Import functions</h3>
<p>Once you’ve saved your data file in a suitable format we can now read this file into R. The workhorse function for importing data into R is the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function (we discuss some alternatives later in the chapter). The <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function is a very flexible function with a shed load of arguments (see <code><a href="https://rdrr.io/r/utils/read.table.html">?read.table</a></code>) but it’s quite simple to use. Let’s import a comma delimited file called <code>unicorns.csv</code> which contains the data we saw previously in this Chapter (<a href="#sec-df" class="quarto-xref"><span>Section 3.2.4</span></a>) and assign it to an object called <code>unicorns</code>. The file is located in a <code>data</code> directory which itself is located in our root directory (<a href="01-start.html#sec-dir-struc" class="quarto-xref"><span>Section 1.4</span></a>). The first row of the data contains the variable (column) names. To use the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function to import this file</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/unicorns.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are a few things to note about the above command. First, the file path and the filename (including the file extension) needs to be enclosed in either single or double quotes (i.e. the <code>data/unicorns.txt</code> bit) as the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function expects this to be a character string. If your working directory is already set to the directory which contains the file, you don’t need to include the entire file path just the filename. In the example above, the file path is separated with a single forward slash <code>/</code>. This will work regardless of the operating system you are using and we recommend you stick with this. However, Windows users may be more familiar with the single backslash notation and if you want to keep using this you will need to include them as double backslashes.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note though that the double backslash notation will <strong>not</strong> work on computers using Mac OSX or Linux operating systems. We thus strongly discourage it since it is not reproducible</p>
</div>
</div>
<p>The <code>header = TRUE</code> argument specifies that the first row of your data contains the variable names (i.e. <code>food</code>, <code>block</code> etc). If this is not the case you can specify <code>header = FALSE</code> (actually, this is the default value so you can omit this argument entirely). The <code>sep = ","</code> argument tells R what is file delimiter.</p>
<p>Other useful arguments include <code>dec =</code> and <code>na.strings =</code>. The <code>dec =</code> argument allows you to change the default character (<code>.</code>) used for a decimal point. This is useful if you’re in a country where decimal places are usually represented by a comma (i.e. <code>dec = ","</code>). The <code>na.strings =</code> argument allows you to import data where missing values are represented with a symbol other than <code>NA</code>. This can be quite common if you are importing data from other statistical software such as Minitab which represents missing values as a <code>*</code> (<code>na.strings = "*"</code>).</p>
<p>Honestly, from the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> a series of predefined functions are available. They are all using <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> but define format specific options. We can simply <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>to read a csv file, with “,” separation and “.” for decimals. In countries were “,” is used for decimals, csv files use “;” as a separator. In this case using <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv2()</a></code> would be needed. When working with tab delimited files, the functions <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> and <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim2()</a></code> can be used with “.” and “,” as decimal respectively.</p>
<p>After importing our data into R , to see the contents of the data frame we could just type the name of the object as we have done previously. <strong>BUT</strong> before you do that, think about why you’re doing this. If your data frame is anything other than tiny, all you’re going to do is fill up your Console with data. It’s not like you can easily check whether there are any errors or that your data has been imported correctly. A much better solution is to use our old friend the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function to return a compact and informative summary of your data frame.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   96 obs. of  8 variables:
 $ p_care    : Factor w/ 2 levels "care","no_care": 1 1 1 1 1 1 1 1 1 1 ...
 $ food      : Factor w/ 3 levels "high","low","medium": 3 3 3 3 3 3 3 3 3 3 ...
 $ block     : int  1 1 1 1 1 1 1 1 2 2 ...
 $ height    : num  7.5 10.7 11.2 10.4 10.4 9.8 6.9 9.4 10.4 12.3 ...
 $ weight    : num  7.62 12.14 12.76 8.78 13.58 ...
 $ mane_size : num  11.7 14.1 7.1 11.9 14.5 12.2 13.2 14 10.5 16.1 ...
 $ fluffyness: num  31.9 46 66.7 20.3 26.9 72.7 43.1 28.5 57.8 36.9 ...
 $ horn_rings: int  1 10 10 1 4 9 7 6 5 8 ...</code></pre>
</div>
</div>
<p>Here we see that <code>unicorns</code> is a ‘data.frame’ object which contains 96 rows and 8 variables (columns). Each of the variables are listed along with their data class and the first 10 values. As we mentioned previously in this Chapter, it can be quite convenient to copy and paste this into your R script as a comment block for later reference.</p>
<p>Notice also that your character string variables (<code>care</code> and <code>food</code>) have been imported as factors because we used the argument <code>stringsAsFactors = TRUE</code>. If this is not what you want you can prevent this by using the <code>stringsAsFactors = FALSE</code> or from R version 4.0.0 you can just leave out this argument as <code>stringsAsFactors = FALSE</code> is the default.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   96 obs. of  8 variables:
 $ p_care    : chr  "care" "care" "care" "care" ...
 $ food      : chr  "medium" "medium" "medium" "medium" ...
 $ block     : int  1 1 1 1 1 1 1 1 2 2 ...
 $ height    : num  7.5 10.7 11.2 10.4 10.4 9.8 6.9 9.4 10.4 12.3 ...
 $ weight    : num  7.62 12.14 12.76 8.78 13.58 ...
 $ mane_size : num  11.7 14.1 7.1 11.9 14.5 12.2 13.2 14 10.5 16.1 ...
 $ fluffyness: num  31.9 46 66.7 20.3 26.9 72.7 43.1 28.5 57.8 36.9 ...
 $ horn_rings: int  1 10 10 1 4 9 7 6 5 8 ...</code></pre>
</div>
</div>
<p>If we just wanted to see the names of our variables (columns) in the data frame we can use the <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> function which will return a character vector of the variable names.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p_care"     "food"       "block"      "height"     "weight"    
[6] "mane_size"  "fluffyness" "horn_rings"</code></pre>
</div>
</div>
<p>You can even import spreadsheet files from MS Excel or other statistics software directly into R but our advice is that this should generally be avoided if possible as it just adds a layer of uncertainty between you and your data. In our opinion it’s almost always better to export your spreadsheets as tab or comma delimited files and then import them into R using one of the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> derivative function. If you’re hell bent on directly importing data from other software you will need to install the <code>foreign</code> package which has functions for importing Minitab, SPSS, Stata and SAS files. For MS Excel and LO Calc spreadsheets, there are a few packages that can be used.</p>
</section><section id="common-import-frustrations" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="common-import-frustrations">
<span class="header-section-number">3.3.3</span> Common import frustrations</h3>
<p>It’s quite common to get a bunch of really frustrating error messages when you first start importing data into R. Perhaps the most common is</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">file</span>(file, <span class="st">"rt"</span>) <span class="sc">:</span> cannot open the connection</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>In addition<span class="sc">:</span> Warning message<span class="sc">:</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>In <span class="fu">file</span>(file, <span class="st">"rt"</span>) <span class="sc">:</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  cannot open file <span class="st">'unicorns.txt'</span><span class="sc">:</span> No such file or directory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This error message is telling you that R cannot find the file you are trying to import. It usually rears its head for one of a couple of reasons (or all of them!). The first is that you’ve made a mistake in the spelling of either the filename or file path. Another common mistake is that you have forgotten to include the file extension in the filename (i.e. <code>.txt</code>). Lastly, the file is not where you say it is or you’ve used an incorrect file path. Using RStudio Projects (<a href="01-start.html#sec-rsprojs" class="quarto-xref"><span>Section 1.5</span></a>) and having a logical directory structure (<a href="01-start.html#sec-dir-struc" class="quarto-xref"><span>Section 1.4</span></a>) goes a long way to avoiding these types of errors.</p>
<p>Another really common mistake is to forget to include the <code>header = TRUE</code> argument when the first row of the data contains variable names. For example, if we omit this argument when we import our <code>unicorns.txt</code> file everything looks OK at first (no error message at least)</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns_bad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>but when we take a look at our data frame using <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code></p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unicorns_bad</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   97 obs. of  8 variables:
 $ V1: chr  "p_care" "care" "care" "care" ...
 $ V2: chr  "food" "medium" "medium" "medium" ...
 $ V3: chr  "block" "1" "1" "1" ...
 $ V4: chr  "height" "7.5" "10.7" "11.2" ...
 $ V5: chr  "weight" "7.62" "12.14" "12.76" ...
 $ V6: chr  "mane_size" "11.7" "14.1" "7.1" ...
 $ V7: chr  "fluffyness" "31.9" "46" "66.7" ...
 $ V8: chr  "horn_rings" "1" "10" "10" ...</code></pre>
</div>
</div>
<p>We can see an obvious problem, all of our variables have been imported as factors and our variables are named <code>V1</code>, <code>V2</code>, <code>V3</code> … <code>V8</code>. The problem happens because we haven’t told the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function that the first row contains the variable names and so it treats them as data. As soon as we have a single character string in any of our data vectors, R treats the vectors as character type data (remember all elements in a vector must contain the same type of data (<a href="#sec-scal-vecs" class="quarto-xref"><span>Section 3.2.1</span></a>)).</p>
<p>This is just one more argument to use <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> or <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code> function with appropriate default values for arguments.</p>
</section><section id="sec-import-other" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="sec-import-other">
<span class="header-section-number">3.3.4</span> Other import options</h3>
<p>There are numerous other functions to import data from a variety of sources and formats. Most of these functions are contained in packages that you will need to install before using them. We list a couple of the more useful packages and functions below.</p>
<p>The <code>fread()</code> function from the <code>read.table</code> package is great for importing large data files quickly and efficiently (much faster than the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function). One of the great things about the <code>fread()</code> function is that it will automatically detect many of the arguments you would normally need to specify (like <code>sep =</code> etc). One of the things you will need to consider though is that the <code>fread()</code> function will return a <code>data.table</code> object not a <code>data.frame</code> as would be the case with the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function. This is usually not a problem as you can pass a <code>data.table</code> object to any function that only accepts <code>data.frame</code> objects. To learn more about the differences between <code>data.table</code> and <code>data.frame</code> objects see <a href="http://datatable.r-forge.r-project.org/datatable-intro.pdf">here</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">read.table</span><span class="op">)</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Various functions from the <code>readr</code> package are also very efficient at reading in large data files. The <code>readr</code> package is part of the ‘<a href="https://www.tidyverse.org/">tidyverse</a>’ collection of packages and provides many equivalent functions to base R for importing data. The <code>readr</code> functions are used in a similar way to the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> or <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> functions and many of the arguments are the same (see <code><a href="https://readr.tidyverse.org/reference/read_table.html">?readr::read_table</a></code> for more details). There are however some differences. For example, when using the <code><a href="https://readr.tidyverse.org/reference/read_table.html">read_table()</a></code> function the <code>header = TRUE</code> argument is replaced by <code>col_names = TRUE</code> and the function returns a <code>tibble</code> class object which is the tidyverse equivalent of a <code>data.frame</code> object (see <a href="https://blog.rstudio.com/2016/03/24/tibble-1-0-0/">here</a> for differences).</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="co"># import white space delimited files</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import comma delimited files</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import tab delimited files</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or use</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If your data file is ginormous, then the <code>ff</code> and <code>bigmemory</code> packages may be useful as they both contain import functions that are able to store large data in a memory efficient manner. You can find out more about these functions <a href="https://www.rdocumentation.org/packages/ff/versions/2.2-14/topics/read.table.ffdf">here</a> and <a href="https://cran.r-project.org/web/packages/bigmemory/bigmemory.pdf">here</a>.</p>
</section></section><section id="wrangling-data-frames" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="wrangling-data-frames">
<span class="header-section-number">3.4</span> Wrangling data frames</h2>
<p>Now that you’re able to successfully import your data from an external file into R our next task is to do something useful with our data. Working with data is a fundamental skill which you’ll need to develop and get comfortable with as you’ll likely do a lot of it during any project. The good news is that R is especially good at manipulating, summarising and visualising data. Manipulating data (often known as data wrangling or munging) in R can at first seem a little daunting for the new user but if you follow a few simple logical rules then you’ll quickly get the hang of it, especially with some practice.</p>
<p>Let’s remind ourselves of the structure of the <code>unicorns</code> data frame we imported in the previous section.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unicorns.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   96 obs. of  8 variables:
 $ p_care    : chr  "care" "care" "care" "care" ...
 $ food      : chr  "medium" "medium" "medium" "medium" ...
 $ block     : int  1 1 1 1 1 1 1 1 2 2 ...
 $ height    : num  7.5 10.7 11.2 10.4 10.4 9.8 6.9 9.4 10.4 12.3 ...
 $ weight    : num  7.62 12.14 12.76 8.78 13.58 ...
 $ mane_size : num  11.7 14.1 7.1 11.9 14.5 12.2 13.2 14 10.5 16.1 ...
 $ fluffyness: num  31.9 46 66.7 20.3 26.9 72.7 43.1 28.5 57.8 36.9 ...
 $ horn_rings: int  1 10 10 1 4 9 7 6 5 8 ...</code></pre>
</div>
</div>
<p>To access the data in any of the variables (columns) in our data frame we can use the <code>$</code> notation. For example, to access the <code>height</code> variable in our <code>unicorns</code> data frame we can use <code>unicorns$height</code>. This tells R that the <code>height</code> variable is contained within the data frame <code>unicorns</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  7.5 10.7 11.2 10.4 10.4  9.8  6.9  9.4 10.4 12.3 10.4 11.0  7.1  6.0  9.0
[16]  4.5 12.6 10.0 10.0  8.5 14.1 10.1  8.5  6.5 11.5  7.7  6.4  8.8  9.2  6.2
[31]  6.3 17.2  8.0  8.0  6.4  7.6  9.7 12.3  9.1  8.9  7.4  3.1  7.9  8.8  8.5
[46]  5.6 11.5  5.8  5.6  5.3  7.5  4.1  3.5  8.5  4.9  2.5  5.4  3.9  5.8  4.5
[61]  8.0  1.8  2.2  3.9  8.5  8.5  6.4  1.2  2.6 10.9  7.2  2.1  4.7  5.0  6.5
[76]  2.6  6.0  9.3  4.6  5.2  3.9  2.3  5.2  2.2  4.5  1.8  3.0  3.7  2.4  5.7
[91]  3.7  3.2  3.9  3.3  5.5  4.4</code></pre>
</div>
</div>
<p>This will return a vector of the <code>height</code> data. If we want we can assign this vector to another object and do stuff with it, like calculate a mean or get a summary of the variable using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f_height</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">height</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">f_height</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.839583</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f_height</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.200   4.475   6.450   6.840   9.025  17.200 </code></pre>
</div>
</div>
<p>Or if we don’t want to create an additional object we can use functions ‘on-the-fly’ to only display the value in the console.</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.839583</code></pre>
</div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.200   4.475   6.450   6.840   9.025  17.200 </code></pre>
</div>
</div>
<p>Just as we did with vectors (<a href="02-basics.html#sec-vectors" class="quarto-xref"><span>Section 2.5</span></a>), we also can access data in data frames using the square bracket <code>[ ]</code> notation. However, instead of just using a single index, we now need to use two indexes, one to specify the rows and one for the columns. To do this, we can use the notation <code>my_data[rows, columns]</code> where <code>rows</code> and <code>columns</code> are indexes and <code>my_data</code> is the name of the data frame. Again, just like with our vectors our indexes can be positional or the result of a logical test.</p>
<section id="positional-indexes" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="positional-indexes">
<span class="header-section-number">3.4.1</span> Positional indexes</h3>
<p>To use positional indexes we simple have to write the position of the rows and columns we want to extract inside the <code>[ ]</code>. For example, if for some reason we wanted to extract the first value (1<sup>st</sup> row ) of the <code>height</code> variable (4<sup>th</sup> column)</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.5</code></pre>
</div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># this would give you the same</span></span>
<span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.5</code></pre>
</div>
</div>
<p>We can also extract values from multiple rows or columns by specifying these indexes as vectors inside the <code>[ ]</code>. To extract the first 10 rows and the first 4 columns we simple supply a vector containing a sequence from 1 to 10 for the rows index (<code>1:10</code>) and a vector from 1 to 4 for the column index (<code>1:4</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p_care   food block height
1    care medium     1    7.5
2    care medium     1   10.7
3    care medium     1   11.2
4    care medium     1   10.4
5    care medium     1   10.4
6    care medium     1    9.8
7    care medium     1    6.9
8    care medium     1    9.4
9    care medium     2   10.4
10   care medium     2   12.3</code></pre>
</div>
</div>
<p>Or for non sequential rows and columns then we can supply vectors of positions using the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function. To extract the 1<sup>st</sup>, 5<sup>th</sup>, 12<sup>th</sup>, 30<sup>th</sup> rows from the 1<sup>st</sup>, 3<sup>rd</sup>, 6<sup>th</sup> and 8<sup>th</sup> columns</p>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p_care block mane_size horn_rings
1    care     1      11.7          1
5    care     1      14.5          4
12   care     2      12.6          6
30   care     2      11.6          5</code></pre>
</div>
</div>
<p>All we are doing in the two examples above is creating vectors of positions for the rows and columns that we want to extract. We have done this by using the skills we developed in <a href="02-basics.html#sec-funcs" class="quarto-xref"><span>Section 2.4</span></a> when we generated vectors using the <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> function or using the <code>:</code> notation.</p>
<p>But what if we want to extract either all of the rows or all of the columns? It would be extremely tedious to have to generate vectors for all rows or for all columns. Thankfully R has a shortcut. If you don’t specify either a row or column index in the <code>[ ]</code> then R interprets it to mean you want all rows or all columns. For example, to extract the first 4 rows and all of the columns in the <code>unicorns</code> data frame</p>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p_care   food block height weight mane_size fluffyness horn_rings
1   care medium     1    7.5   7.62      11.7       31.9          1
2   care medium     1   10.7  12.14      14.1       46.0         10
3   care medium     1   11.2  12.76       7.1       66.7         10
4   care medium     1   10.4   8.78      11.9       20.3          1</code></pre>
</div>
</div>
<p>or all of the rows and the first 3 columns<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block
1     care medium     1
2     care medium     1
3     care medium     1
4     care medium     1
5     care medium     1
92 no_care    low     2
93 no_care    low     2
94 no_care    low     2
95 no_care    low     2
96 no_care    low     2</code></pre>
</div>
</div>
<p>We can even use negative positional indexes to exclude certain rows and columns. As an example, lets extract all of the rows except the first 85 rows and all columns except the 4<sup>th</sup>, 7<sup>th</sup> and 8<sup>th</sup> columns. Notice we need to use <code>-()</code> when we generate our row positional vectors. If we had just used <code>-1:85</code> this would actually generate a regular sequence from -1 to 85 which is not what we want (we can of course use <code>-1:-85</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">85</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care food block weight mane_size
86 no_care  low     1   6.01      17.6
87 no_care  low     1   9.93      12.0
88 no_care  low     1   7.03       7.9
89 no_care  low     2   9.10      14.5
90 no_care  low     2   9.05       9.6
91 no_care  low     2   8.10      10.5
92 no_care  low     2   7.45      14.1
93 no_care  low     2   9.19      12.4
94 no_care  low     2   8.92      11.6
95 no_care  low     2   8.44      13.5
96 no_care  low     2  10.60      16.2</code></pre>
</div>
</div>
<p>In addition to using a positional index for extracting particular columns (variables) we can also name the variables directly when using the square bracket <code>[ ]</code> notation. For example, let’s extract the first 5 rows and the variables <code>care</code>, <code>food</code> and <code>mane_size</code>. Instead of using <code>unicorns[1:5, c(1, 2, 6)]</code> we can instead use</p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p_care"</span>, <span class="st">"food"</span>, <span class="st">"mane_size"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p_care   food mane_size
1   care medium      11.7
2   care medium      14.1
3   care medium       7.1
4   care medium      11.9
5   care medium      14.5</code></pre>
</div>
</div>
<p>We often use this method in preference to the positional index for selecting columns as it will still give us what we want even if we’ve changed the order of the columns in our data frame for some reason.</p>
</section><section id="logical-indexes" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="logical-indexes">
<span class="header-section-number">3.4.2</span> Logical indexes</h3>
<p>Just as we did with vectors, we can also extract data from our data frame based on a logical test. We can use all of the logical operators that we used for our vector examples so if these have slipped your mind maybe have a look at <a href="02-basics.html#sec-logical-index" class="quarto-xref"><span>Section 2.5.1.1</span></a> and refresh your memory. Let’s extract all rows where <code>height</code> is greater than 12 and extract all columns by default (remember, if you don’t include a column index after the comma it means all columns).</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">big_unicorns</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&gt;</span> <span class="fl">12</span>, <span class="op">]</span></span>
<span><span class="va">big_unicorns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p_care   food block height weight mane_size fluffyness horn_rings
10   care medium     2   12.3  13.48      16.1       36.9          8
17   care   high     1   12.6  18.66      18.6       54.0          9
21   care   high     1   14.1  19.12      13.1      113.2         13
32   care   high     2   17.2  19.20      10.9       89.9         14
38   care    low     1   12.3  11.27      13.7       28.7          5</code></pre>
</div>
</div>
<p>Notice in the code above that we need to use the <code>unicorns$height</code> notation for the logical test. If we just named the <code>height</code> variable without the name of the data frame we would receive an error telling us R couldn’t find the variable <code>height</code>. The reason for this is that the <code>height</code> variable only exists inside the <code>unicorns</code> data frame so you need to tell R exactly where it is.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>big_unicorns <span class="ot">&lt;-</span> unicorns[height <span class="sc">&gt;</span> <span class="dv">12</span>, ]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="st">`</span><span class="at">[.data.frame</span><span class="st">`</span>(unicorns, height <span class="sc">&gt;</span> <span class="dv">12</span>, ) <span class="sc">:</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  object <span class="st">'height'</span> not found</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So how does this work? The logical test is <code>unicorns$height &gt; 12</code> and R will only extract those rows that satisfy this logical condition. If we look at the output of just the logical condition you can see this returns a vector containing <code>TRUE</code> if <code>height</code> is greater than 12 and <code>FALSE</code> if <code>height</code> is not greater than 12.</p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&gt;</span> <span class="fl">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
[13] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
[25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE
[37] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[73] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>So our row index is a vector containing either <code>TRUE</code> or <code>FALSE</code> values and only those rows that are <code>TRUE</code> are selected.</p>
<p>Other commonly used operators are shown below</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&gt;=</span> <span class="fl">6</span>, <span class="op">]</span> <span class="co"># values greater or equal to 6</span></span>
<span></span>
<span><span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;=</span> <span class="fl">6</span>, <span class="op">]</span> <span class="co"># values less than or equal to 6</span></span>
<span></span>
<span><span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">==</span> <span class="fl">8</span>, <span class="op">]</span> <span class="co"># values  equal to 8</span></span>
<span></span>
<span><span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">!=</span> <span class="fl">8</span>, <span class="op">]</span> <span class="co"># values  not equal to 8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also extract rows based on the value of a character string or factor level. Let’s extract all rows where the <code>food</code> level is equal to <code>high</code> (again we will output all columns). Notice that the double equals <code>==</code> sign must be used for a logical test and that the character string must be enclosed in either single or double quotes (i.e. <code>"high"</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">food_high</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span> <span class="op">==</span> <span class="st">"high"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">food_high</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">food_high</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care food block height weight mane_size fluffyness horn_rings
17    care high     1   12.6  18.66      18.6       54.0          9
18    care high     1   10.0  18.07      16.9       90.5          3
19    care high     1   10.0  13.29      15.8      142.7         12
20    care high     1    8.5  14.33      13.2       91.4          5
21    care high     1   14.1  19.12      13.1      113.2         13
22    care high     1   10.1  15.49      12.6       77.2         12
23    care high     1    8.5  17.82      20.5       54.4          3
24    care high     1    6.5  17.13      24.1      147.4          6
25    care high     2   11.5  23.89      14.3      101.5         12
26    care high     2    7.7  14.77      17.2      104.5          4
71 no_care high     1    7.2  15.21      15.9      135.0         14
72 no_care high     1    2.1  19.15      15.6      176.7          6
73 no_care high     2    4.7  13.42      19.8      124.7          5
74 no_care high     2    5.0  16.82      17.3      182.5         15
75 no_care high     2    6.5  14.00      10.1      126.5          7
76 no_care high     2    2.6  18.88      16.4      181.5         14
77 no_care high     2    6.0  13.68      16.2      133.7          2
78 no_care high     2    9.3  18.75      18.4      181.1         16
79 no_care high     2    4.6  14.65      16.7       91.7         11
80 no_care high     2    5.2  17.70      19.1      181.1          8</code></pre>
</div>
</div>
<p>Or we can extract all rows where <code>food</code> level is not equal to <code>medium</code> (using <code>!=</code>) and only return columns 1 to 4.</p>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">food_not_medium</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span> <span class="op">!=</span> <span class="st">"medium"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">food_not_medium</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">food_not_medium</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care food block height
17    care high     1   12.6
18    care high     1   10.0
19    care high     1   10.0
20    care high     1    8.5
21    care high     1   14.1
22    care high     1   10.1
23    care high     1    8.5
24    care high     1    6.5
25    care high     2   11.5
26    care high     2    7.7
87 no_care  low     1    3.0
88 no_care  low     1    3.7
89 no_care  low     2    2.4
90 no_care  low     2    5.7
91 no_care  low     2    3.7
92 no_care  low     2    3.2
93 no_care  low     2    3.9
94 no_care  low     2    3.3
95 no_care  low     2    5.5
96 no_care  low     2    4.4</code></pre>
</div>
</div>
<p>We can increase the complexity of our logical tests by combining them with <a href="https://en.wikipedia.org/wiki/Boolean_expression">Boolean expressions</a> just as we did for vector objects. For example, to extract all rows where <code>height</code> is greater or equal to <code>6</code> AND <code>food</code> is equal to <code>medium</code> AND <code>care</code> is equal to <code>no_care</code> we combine a series of logical expressions with the <code>&amp;</code> symbol.</p>
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">low_no_care_heigh6</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&gt;=</span> <span class="fl">6</span> <span class="op">&amp;</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span> <span class="op">==</span> <span class="st">"medium"</span> <span class="op">&amp;</span></span>
<span>  <span class="va">unicorns</span><span class="op">$</span><span class="va">p_care</span> <span class="op">==</span> <span class="st">"no_care"</span>, <span class="op">]</span></span>
<span><span class="va">low_no_care_heigh6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
51 no_care medium     1    7.5  13.60      13.6      122.2         11
54 no_care medium     1    8.5  10.04      12.3      113.6          4
61 no_care medium     2    8.0  11.43      12.6       43.2         14</code></pre>
</div>
</div>
<p>To extract rows based on an ‘OR’ Boolean expression we can use the <code>|</code> symbol. Let’s extract all rows where <code>height</code> is greater than 12.3 OR less than 2.2.</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">height2.2_12.3</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&gt;</span> <span class="fl">12.3</span> <span class="op">|</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;</span> <span class="fl">2.2</span>, <span class="op">]</span></span>
<span><span class="va">height2.2_12.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
17    care   high     1   12.6  18.66      18.6       54.0          9
21    care   high     1   14.1  19.12      13.1      113.2         13
32    care   high     2   17.2  19.20      10.9       89.9         14
62 no_care medium     2    1.8  10.47      11.8      120.8          9
68 no_care   high     1    1.2  18.24      16.6      148.1          7
72 no_care   high     1    2.1  19.15      15.6      176.7          6
86 no_care    low     1    1.8   6.01      17.6       46.2          4</code></pre>
</div>
</div>
<p>An alternative method of selecting parts of a data frame based on a logical expression is to use the <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> function instead of the <code>[ ]</code>. The advantage of using <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> is that you no longer need to use the <code>$</code> notation when specifying variables inside the data frame as the first argument to the function is the name of the data frame to be subsetted. The disadvantage is that <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> is less flexible than the <code>[ ]</code> notation.</p>
<div class="cell">
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">care_med_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">unicorns</span>, <span class="va">p_care</span> <span class="op">==</span> <span class="st">"care"</span> <span class="op">&amp;</span> <span class="va">food</span> <span class="op">==</span> <span class="st">"medium"</span> <span class="op">&amp;</span> <span class="va">block</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">care_med_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p_care   food block height weight mane_size fluffyness horn_rings
9    care medium     2   10.4  10.48      10.5       57.8          5
10   care medium     2   12.3  13.48      16.1       36.9          8
11   care medium     2   10.4  13.18      11.1       56.8         12
12   care medium     2   11.0  11.56      12.6       31.3          6
13   care medium     2    7.1   8.16      29.6        9.7          2
14   care medium     2    6.0  11.22      13.0       16.4          3
15   care medium     2    9.0  10.20      10.8       90.1          6
16   care medium     2    4.5  12.55      13.4       14.4          6</code></pre>
</div>
</div>
<p>And if you only want certain columns you can use the <code>select =</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">uni_p_care</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">unicorns</span>, <span class="va">p_care</span> <span class="op">==</span> <span class="st">"care"</span> <span class="op">&amp;</span> <span class="va">food</span> <span class="op">==</span> <span class="st">"medium"</span> <span class="op">&amp;</span> <span class="va">block</span> <span class="op">==</span> <span class="fl">2</span>,</span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p_care"</span>, <span class="st">"food"</span>, <span class="st">"mane_size"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">uni_p_care</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   p_care   food mane_size
9    care medium      10.5
10   care medium      16.1
11   care medium      11.1
12   care medium      12.6
13   care medium      29.6
14   care medium      13.0
15   care medium      10.8
16   care medium      13.4</code></pre>
</div>
</div>
</section><section id="ordering-data-frames" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="ordering-data-frames">
<span class="header-section-number">3.4.3</span> Ordering data frames</h3>
<p>Remember when we used the function <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> to order one vector based on the order of another vector (way back in <a href="02-basics.html#sec-vec-ord" class="quarto-xref"><span>Section 2.5.3</span></a>). This comes in very handy if you want to reorder rows in your data frame. For example, if we want all of the rows in the data frame <code>unicorns</code> to be ordered in ascending value of <code>height</code> and output all columns by default.</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">height_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">height_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
68 no_care   high     1    1.2  18.24      16.6      148.1          7
62 no_care medium     2    1.8  10.47      11.8      120.8          9
86 no_care    low     1    1.8   6.01      17.6       46.2          4
72 no_care   high     1    2.1  19.15      15.6      176.7          6
63 no_care medium     2    2.2  10.70      15.3       97.1          7
84 no_care    low     1    2.2   9.97       9.6       63.1          2
82 no_care    low     1    2.3   7.28      13.8       32.8          6
89 no_care    low     2    2.4   9.10      14.5       78.7          8
56 no_care medium     1    2.5  14.85      17.5       77.8         10
69 no_care   high     1    2.6  16.57      17.1      141.1          3</code></pre>
</div>
</div>
<p>We can also order by descending order of a variable (i.e. <code>mane_size</code>) using the <code>decreasing = TRUE</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mane_size_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">mane_size</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mane_size_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
70 no_care   high     1   10.9  17.22      49.2      189.6         17
13    care medium     2    7.1   8.16      29.6        9.7          2
24    care   high     1    6.5  17.13      24.1      147.4          6
65 no_care   high     1    8.5  22.53      20.8      166.9         16
23    care   high     1    8.5  17.82      20.5       54.4          3
66 no_care   high     1    8.5  17.33      19.8      184.4         12
73 no_care   high     2    4.7  13.42      19.8      124.7          5
80 no_care   high     2    5.2  17.70      19.1      181.1          8
17    care   high     1   12.6  18.66      18.6       54.0          9
49 no_care medium     1    5.6  11.03      18.6       49.9          8</code></pre>
</div>
</div>
<p>We can even order data frames based on multiple variables. For example, to order the data frame <code>unicorns</code> in ascending order of both <code>block</code> and <code>height</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">block_height_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">block</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">block_height_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
68 no_care   high     1    1.2  18.24      16.6      148.1          7
86 no_care    low     1    1.8   6.01      17.6       46.2          4
72 no_care   high     1    2.1  19.15      15.6      176.7          6
84 no_care    low     1    2.2   9.97       9.6       63.1          2
82 no_care    low     1    2.3   7.28      13.8       32.8          6
56 no_care medium     1    2.5  14.85      17.5       77.8         10
69 no_care   high     1    2.6  16.57      17.1      141.1          3
87 no_care    low     1    3.0   9.93      12.0       56.6          6
53 no_care medium     1    3.5  12.93      16.6      109.3          3
88 no_care    low     1    3.7   7.03       7.9       36.7          5</code></pre>
</div>
</div>
<p>What if we wanted to order <code>unicorns</code> by ascending order of <code>block</code> but descending order of <code>height</code>? We can use a simple trick by adding a <code>-</code> symbol before the <code>unicorns$height</code> variable when we use the <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> function. This will essentially turn all of the <code>height</code> values negative which will result in reversing the order. Note, that this trick will only work with numeric variables.</p>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">block_revheight_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">block</span>, <span class="op">-</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">block_revheight_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">block_revheight_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
21    care   high     1   14.1  19.12      13.1      113.2         13
17    care   high     1   12.6  18.66      18.6       54.0          9
38    care    low     1   12.3  11.27      13.7       28.7          5
3     care medium     1   11.2  12.76       7.1       66.7         10
70 no_care   high     1   10.9  17.22      49.2      189.6         17
2     care medium     1   10.7  12.14      14.1       46.0         10
4     care medium     1   10.4   8.78      11.9       20.3          1
5     care medium     1   10.4  13.58      14.5       26.9          4
22    care   high     1   10.1  15.49      12.6       77.2         12
18    care   high     1   10.0  18.07      16.9       90.5          3
64 no_care medium     2    3.9  12.97      17.0       97.5          5
93 no_care    low     2    3.9   9.19      12.4       52.6          9
91 no_care    low     2    3.7   8.10      10.5       60.5          6
94 no_care    low     2    3.3   8.92      11.6       55.2          6
92 no_care    low     2    3.2   7.45      14.1       38.1          4
42    care    low     2    3.1   8.74      16.1       39.1          3
76 no_care   high     2    2.6  18.88      16.4      181.5         14
89 no_care    low     2    2.4   9.10      14.5       78.7          8
63 no_care medium     2    2.2  10.70      15.3       97.1          7
62 no_care medium     2    1.8  10.47      11.8      120.8          9</code></pre>
</div>
</div>
<p>If we wanted to do the same thing with a factor (or character) variable like <code>food</code> we would need to use the function <code><a href="https://rdrr.io/r/base/xtfrm.html">xtfrm()</a></code> for this variable inside our <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">block_revheight_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/xtfrm.html">xtfrm</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span><span class="op">)</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">block_revheight_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">block_revheight_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care   food block height weight mane_size fluffyness horn_rings
62 no_care medium     2    1.8  10.47      11.8      120.8          9
63 no_care medium     2    2.2  10.70      15.3       97.1          7
56 no_care medium     1    2.5  14.85      17.5       77.8         10
53 no_care medium     1    3.5  12.93      16.6      109.3          3
58 no_care medium     2    3.9   9.07       9.6       90.4          7
64 no_care medium     2    3.9  12.97      17.0       97.5          5
52 no_care medium     1    4.1  12.58      13.9      136.6         11
16    care medium     2    4.5  12.55      13.4       14.4          6
60 no_care medium     2    4.5  13.68      14.8      125.5          9
55 no_care medium     1    4.9   6.89       8.2       52.9          3
29    care   high     2    9.2  13.26      11.3      108.0          9
78 no_care   high     2    9.3  18.75      18.4      181.1         16
18    care   high     1   10.0  18.07      16.9       90.5          3
19    care   high     1   10.0  13.29      15.8      142.7         12
22    care   high     1   10.1  15.49      12.6       77.2         12
70 no_care   high     1   10.9  17.22      49.2      189.6         17
25    care   high     2   11.5  23.89      14.3      101.5         12
17    care   high     1   12.6  18.66      18.6       54.0          9
21    care   high     1   14.1  19.12      13.1      113.2         13
32    care   high     2   17.2  19.20      10.9       89.9         14</code></pre>
</div>
</div>
<p>Notice that the <code>food</code> variable has been reverse ordered alphabetically and <code>height</code> has been ordered by increasing values within each level of <code>food</code>.</p>
<p>If we wanted to order the data frame by <code>food</code> but this time order it from <code>low</code> -&gt; <code>medium</code> -&gt; <code>high</code> instead of the default alphabetically (<code>high</code>, <code>low</code>, <code>medium</code>), we need to first change the order of our levels of the <code>food</code> factor in our data frame using the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function. Once we’ve done this we can then use the <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> function as usual. Note, if you’re reading the pdf version of this book, the output has been truncated to save space.</p>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">food_ord</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">food_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">food_ord</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care food block height weight mane_size fluffyness horn_rings
33    care  low     1    8.0   6.88       9.3       16.1          4
34    care  low     1    8.0  10.23      11.9       88.1          4
35    care  low     1    6.4   5.97       8.7        7.3          2
36    care  low     1    7.6  13.05       7.2       47.2          8
37    care  low     1    9.7   6.49       8.1       18.0          3
38    care  low     1   12.3  11.27      13.7       28.7          5
39    care  low     1    9.1   8.96       9.7       23.8          3
40    care  low     1    8.9  11.48      11.1       39.4          7
41    care  low     2    7.4  10.89      13.3        9.5          5
42    care  low     2    3.1   8.74      16.1       39.1          3
71 no_care high     1    7.2  15.21      15.9      135.0         14
72 no_care high     1    2.1  19.15      15.6      176.7          6
73 no_care high     2    4.7  13.42      19.8      124.7          5
74 no_care high     2    5.0  16.82      17.3      182.5         15
75 no_care high     2    6.5  14.00      10.1      126.5          7
76 no_care high     2    2.6  18.88      16.4      181.5         14
77 no_care high     2    6.0  13.68      16.2      133.7          2
78 no_care high     2    9.3  18.75      18.4      181.1         16
79 no_care high     2    4.6  14.65      16.7       91.7         11
80 no_care high     2    5.2  17.70      19.1      181.1          8</code></pre>
</div>
</div>
</section><section id="adding-columns-and-rows" class="level3" data-number="3.4.4"><h3 data-number="3.4.4" class="anchored" data-anchor-id="adding-columns-and-rows">
<span class="header-section-number">3.4.4</span> Adding columns and rows</h3>
<p>Sometimes it’s useful to be able to add extra rows and columns of data to our data frames. There are multiple ways to achieve this (as there always is in R!) depending on your circumstances. To simply append additional rows to an existing data frame we can use the <code><a href="https://rdrr.io/r/base/cbind.html">rbind()</a></code> function and to append columns the <code><a href="https://rdrr.io/r/base/cbind.html">cbind()</a></code> function. Let’s create a couple of test data frames to see this in action using our old friend the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># rbind for rows</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">150</span>, <span class="fl">132</span>, <span class="fl">122</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">56</span>, <span class="fl">49</span>, <span class="fl">45</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight
1  1    120     44
2  2    150     56
3  3    132     49
4  4    122     45</code></pre>
</div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">6</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">119</span>, <span class="fl">110</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">39</span>, <span class="fl">35</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight
1  5    119     39
2  6    110     35</code></pre>
</div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">150</span>, <span class="fl">132</span>, <span class="fl">122</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">56</span>, <span class="fl">49</span>, <span class="fl">45</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight
1  1    120     44
2  2    150     56
3  3    132     49
4  4    122     45</code></pre>
</div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UK"</span>, <span class="st">"CZ"</span>, <span class="st">"CZ"</span>, <span class="st">"UK"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  location
1       UK
2       CZ
3       CZ
4       UK</code></pre>
</div>
</div>
<p>We can use the <code><a href="https://rdrr.io/r/base/cbind.html">rbind()</a></code> function to append the rows of data in <code>df2</code> to the rows in <code>df1</code> and assign the new data frame to <code>df_rcomb</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_rcomb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span></span>
<span><span class="va">df_rcomb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight
1  1    120     44
2  2    150     56
3  3    132     49
4  4    122     45
5  5    119     39
6  6    110     35</code></pre>
</div>
</div>
<p>And <code>cbind</code> to append the column in <code>df4</code> to the <code>df3</code> data frame and assign to df_ccomb`.</p>
<div class="cell">
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_ccomb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df3</span>, <span class="va">df4</span><span class="op">)</span></span>
<span><span class="va">df_ccomb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight location
1  1    120     44       UK
2  2    150     56       CZ
3  3    132     49       CZ
4  4    122     45       UK</code></pre>
</div>
</div>
<p>Another situation when adding a new column to a data frame is useful is when you want to perform some kind of transformation on an existing variable. For example, say we wanted to apply a log<sub>10</sub> transformation on the height variable in the <code>df_rcomb</code> data frame we created above. We could just create a separate variable to contains these values but it’s good practice to create this variable as a new column inside our existing data frame so we keep all of our data together. Let’s call this new variable <code>height_log10</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># log10 transformation</span></span>
<span><span class="va">df_rcomb</span><span class="op">$</span><span class="va">height_log10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">df_rcomb</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="va">df_rcomb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight height_log10
1  1    120     44     2.079181
2  2    150     56     2.176091
3  3    132     49     2.120574
4  4    122     45     2.086360
5  5    119     39     2.075547
6  6    110     35     2.041393</code></pre>
</div>
</div>
<p>This situation also crops up when we want to convert an existing variable in a data frame from one data class to another data class. For example, the <code>id</code> variable in the <code>df_rcomb</code> data frame is numeric type data (use the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> or <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> functions to check for yourself). If we wanted to convert the <code>id</code> variable to a factor to use later in our analysis we can create a new variable called <code>Fid</code> in our data frame and use the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function to convert the <code>id</code> variable.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># convert to a factor</span></span>
<span><span class="va">df_rcomb</span><span class="op">$</span><span class="va">Fid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df_rcomb</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="va">df_rcomb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id height weight height_log10 Fid
1  1    120     44     2.079181   1
2  2    150     56     2.176091   2
3  3    132     49     2.120574   3
4  4    122     45     2.086360   4
5  5    119     39     2.075547   5
6  6    110     35     2.041393   6</code></pre>
</div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df_rcomb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6 obs. of  5 variables:
 $ id          : int  1 2 3 4 5 6
 $ height      : num  120 150 132 122 119 110
 $ weight      : num  44 56 49 45 39 35
 $ height_log10: num  2.08 2.18 2.12 2.09 2.08 ...
 $ Fid         : Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6</code></pre>
</div>
</div>
</section><section id="merging-data-frames" class="level3" data-number="3.4.5"><h3 data-number="3.4.5" class="anchored" data-anchor-id="merging-data-frames">
<span class="header-section-number">3.4.5</span> Merging data frames</h3>
<p>Instead of just appending either rows or columns to a data frame we can also merge two data frames together. Let’s say we have one data frame that contains taxonomic information on some common UK rocky shore invertebrates (called <code>taxa</code>) and another data frame that contains information on where they are usually found on the rocky shore (called <code>zone</code>). We can merge these two data frames together to produce a single data frame with both taxonomic and location information. Let’s first create both of these data frames (in reality you would probably just import your different datasets).</p>
<div class="cell">
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  GENUS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Patella"</span>, <span class="st">"Littorina"</span>, <span class="st">"Halichondria"</span>, <span class="st">"Semibalanus"</span><span class="op">)</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vulgata"</span>, <span class="st">"littoria"</span>, <span class="st">"panacea"</span>, <span class="st">"balanoides"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"patellidae"</span>, <span class="st">"Littorinidae"</span>, <span class="st">"Halichondriidae"</span>, <span class="st">"Archaeobalanidae"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">taxa</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         GENUS    species           family
1      Patella    vulgata       patellidae
2    Littorina   littoria     Littorinidae
3 Halichondria    panacea  Halichondriidae
4  Semibalanus balanoides Archaeobalanidae</code></pre>
</div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">zone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  genus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Laminaria"</span>, <span class="st">"Halichondria"</span>, <span class="st">"Xanthoria"</span>, <span class="st">"Littorina"</span>,</span>
<span>    <span class="st">"Semibalanus"</span>, <span class="st">"Fucus"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"digitata"</span>, <span class="st">"panacea"</span>, <span class="st">"parietina"</span>, <span class="st">"littoria"</span>,</span>
<span>    <span class="st">"balanoides"</span>, <span class="st">"serratus"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  zone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"v_low"</span>, <span class="st">"low"</span>, <span class="st">"v_high"</span>, <span class="st">"low_mid"</span>, <span class="st">"high"</span>, <span class="st">"low_mid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">zone</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         genus    species    zone
1    Laminaria   digitata   v_low
2 Halichondria    panacea     low
3    Xanthoria  parietina  v_high
4    Littorina   littoria low_mid
5  Semibalanus balanoides    high
6        Fucus   serratus low_mid</code></pre>
</div>
</div>
<p>Because both of our data frames contains at least one variable in common (<code>species</code> in our case) we can simply use the <code><a href="https://rdrr.io/r/base/merge.html">merge()</a></code> function to create a new data frame called <code>taxa_zone</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxa_zone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">taxa</span>, y <span class="op">=</span> <span class="va">zone</span><span class="op">)</span></span>
<span><span class="va">taxa_zone</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     species        GENUS           family        genus    zone
1 balanoides  Semibalanus Archaeobalanidae  Semibalanus    high
2   littoria    Littorina     Littorinidae    Littorina low_mid
3    panacea Halichondria  Halichondriidae Halichondria     low</code></pre>
</div>
</div>
<p>Notice that the merged data frame contains only the rows that have <code>species</code> information in <strong>both</strong> data frames. There are also two columns called <code>GENUS</code> and <code>genus</code> because the <code><a href="https://rdrr.io/r/base/merge.html">merge()</a></code> function treats these as two different variables that originate from the two data frames.</p>
<p>If we want to include all data from both data frames then we will need to use the <code>all = TRUE</code> argument. The missing values will be included as <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxa_zone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">taxa</span>, y <span class="op">=</span> <span class="va">zone</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">taxa_zone</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     species        GENUS           family        genus    zone
1 balanoides  Semibalanus Archaeobalanidae  Semibalanus    high
2   digitata         &lt;NA&gt;             &lt;NA&gt;    Laminaria   v_low
3   littoria    Littorina     Littorinidae    Littorina low_mid
4    panacea Halichondria  Halichondriidae Halichondria     low
5  parietina         &lt;NA&gt;             &lt;NA&gt;    Xanthoria  v_high
6   serratus         &lt;NA&gt;             &lt;NA&gt;        Fucus low_mid
7    vulgata      Patella       patellidae         &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
<p>If the variable names that you want to base the merge on are different in each data frame (for example <code>GENUS</code> and <code>genus</code>) you can specify the names in the first data frame (known as <code>x</code>) and the second data frame (known as <code>y</code>) using the <code>by.x =</code> and <code>by.y =</code> arguments.</p>
<div class="cell">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxa_zone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">taxa</span>, y <span class="op">=</span> <span class="va">zone</span>, by.x <span class="op">=</span> <span class="st">"GENUS"</span>, by.y <span class="op">=</span> <span class="st">"genus"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">taxa_zone</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         GENUS  species.x           family  species.y    zone
1        Fucus       &lt;NA&gt;             &lt;NA&gt;   serratus low_mid
2 Halichondria    panacea  Halichondriidae    panacea     low
3    Laminaria       &lt;NA&gt;             &lt;NA&gt;   digitata   v_low
4    Littorina   littoria     Littorinidae   littoria low_mid
5      Patella    vulgata       patellidae       &lt;NA&gt;    &lt;NA&gt;
6  Semibalanus balanoides Archaeobalanidae balanoides    high
7    Xanthoria       &lt;NA&gt;             &lt;NA&gt;  parietina  v_high</code></pre>
</div>
</div>
<p>Or using multiple variable names.</p>
<div class="cell">
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">taxa_zone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">taxa</span>, y <span class="op">=</span> <span class="va">zone</span>, by.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"GENUS"</span><span class="op">)</span>,</span>
<span>  by.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"genus"</span><span class="op">)</span>, all <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">taxa_zone</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     species        GENUS           family    zone
1 balanoides  Semibalanus Archaeobalanidae    high
2   digitata    Laminaria             &lt;NA&gt;   v_low
3   littoria    Littorina     Littorinidae low_mid
4    panacea Halichondria  Halichondriidae     low
5  parietina    Xanthoria             &lt;NA&gt;  v_high
6   serratus        Fucus             &lt;NA&gt; low_mid
7    vulgata      Patella       patellidae    &lt;NA&gt;</code></pre>
</div>
</div>
</section><section id="sec-reshape" class="level3" data-number="3.4.6"><h3 data-number="3.4.6" class="anchored" data-anchor-id="sec-reshape">
<span class="header-section-number">3.4.6</span> Reshaping data frames</h3>
<p>Reshaping data into different formats is a common task. With rectangular type data (data frames have the same number of rows in each column) there are two main data frame shapes that you will come across: the ‘long’ format (sometimes called stacked) and the ‘wide’ format. An example of a long format data frame is given below. We can see that each row is a single observation from an individual subject and each subject can have multiple rows. This results in a single column of our <code>measurement</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"cond1"</span>, <span class="st">"cond2"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  measurement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">12.9</span>, <span class="fl">14.2</span>, <span class="fl">8.7</span>, <span class="fl">5.2</span>, <span class="fl">12.6</span>, <span class="fl">10.1</span>, <span class="fl">8.9</span>,</span>
<span>    <span class="fl">12.1</span>, <span class="fl">14.2</span>, <span class="fl">10.5</span>, <span class="fl">12.9</span>, <span class="fl">11.9</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">long_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subject sex condition measurement
1        A   M   control        12.9
2        A   M     cond1        14.2
3        A   M     cond2         8.7
4        B   F   control         5.2
5        B   F     cond1        12.6
6        B   F     cond2        10.1
7        C   F   control         8.9
8        C   F     cond1        12.1
9        C   F     cond2        14.2
10       D   M   control        10.5
11       D   M     cond1        12.9
12       D   M     cond2        11.9</code></pre>
</div>
</div>
<p>We can also format the same data in the wide format as shown below. In this format we have multiple observations from each subject in a single row with measurements in different columns (<code>control</code>, <code>cond1</code> and <code>cond2</code>). This is a common format when you have repeated measurements from sampling units.</p>
<div class="cell">
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wide_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12.9</span>, <span class="fl">5.2</span>, <span class="fl">8.9</span>, <span class="fl">10.5</span><span class="op">)</span>,</span>
<span>  cond1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14.2</span>, <span class="fl">12.6</span>, <span class="fl">12.1</span>, <span class="fl">12.9</span><span class="op">)</span>,</span>
<span>  cond2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8.7</span>, <span class="fl">10.1</span>, <span class="fl">14.2</span>, <span class="fl">11.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">wide_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  subject sex control cond1 cond2
1       A   M    12.9  14.2   8.7
2       B   F     5.2  12.6  10.1
3       C   F     8.9  12.1  14.2
4       D   M    10.5  12.9  11.9</code></pre>
</div>
</div>
<p>Whilst there’s no inherent problem with either of these formats we will sometimes need to convert between the two because some functions will require a specific format for them to work. The most common format is the long format.</p>
<p>There are many ways to convert between these two formats but we’ll use the <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> and <code><a href="https://rdrr.io/pkg/reshape2/man/cast.html">dcast()</a></code> functions from the <code>reshape2</code> package (you will need to install this package first). The <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> function is used to convert from wide to long formats. The first argument for the <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> function is the data frame we want to melt (in our case <code>wide_data</code>). The <code>id.vars = c("subject", "sex")</code> argument is a vector of the variables you want to stack, the <code>measured.vars = c("control", "cond1", "cond2")</code> argument identifies the columns of the measurements in different conditions, the <code>variable.name = "condition"</code> argument specifies what you want to call the stacked column of your different conditions in your output data frame and <code>value.name = "measurement"</code> is the name of the column of your stacked measurements in your output data frame.</p>
<div class="cell">
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span></span>
<span><span class="va">wide_data</span> <span class="co"># remind ourselves what the wide format looks like</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  subject sex control cond1 cond2
1       A   M    12.9  14.2   8.7
2       B   F     5.2  12.6  10.1
3       C   F     8.9  12.1  14.2
4       D   M    10.5  12.9  11.9</code></pre>
</div>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># convert wide to long</span></span>
<span><span class="va">my_long_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">wide_data</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>  measured.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"cond1"</span>, <span class="st">"cond2"</span><span class="op">)</span>,</span>
<span>  variable.name <span class="op">=</span> <span class="st">"condition"</span>, value.name <span class="op">=</span> <span class="st">"measurement"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_long_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subject sex condition measurement
1        A   M   control        12.9
2        B   F   control         5.2
3        C   F   control         8.9
4        D   M   control        10.5
5        A   M     cond1        14.2
6        B   F     cond1        12.6
7        C   F     cond1        12.1
8        D   M     cond1        12.9
9        A   M     cond2         8.7
10       B   F     cond2        10.1
11       C   F     cond2        14.2
12       D   M     cond2        11.9</code></pre>
</div>
</div>
<p>The <code><a href="https://rdrr.io/pkg/reshape2/man/cast.html">dcast()</a></code> function is used to convert from a long format data frame to a wide format data frame. The first argument is again is the data frame we want to cast (<code>long_data</code> for this example). The second argument is in formula syntax. The <code>subject + sex</code> bit of the formula means that we want to keep these columns separate, and the <code>~ condition</code> part is the column that contains the labels that we want to split into new columns in our new data frame. The <code>value.var = "measurement"</code> argument is the column that contains the measured data.</p>
<div class="cell">
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">long_data</span> <span class="co"># remind ourselves what the long format look like</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subject sex condition measurement
1        A   M   control        12.9
2        A   M     cond1        14.2
3        A   M     cond2         8.7
4        B   F   control         5.2
5        B   F     cond1        12.6
6        B   F     cond2        10.1
7        C   F   control         8.9
8        C   F     cond1        12.1
9        C   F     cond2        14.2
10       D   M   control        10.5
11       D   M     cond1        12.9
12       D   M     cond2        11.9</code></pre>
</div>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># convert long to wide</span></span>
<span><span class="va">my_wide_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">dcast</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">long_data</span>, <span class="va">subject</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">~</span> <span class="va">condition</span>,</span>
<span>  value.var <span class="op">=</span> <span class="st">"measurement"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">my_wide_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  subject sex cond1 cond2 control
1       A   M  14.2   8.7    12.9
2       B   F  12.6  10.1     5.2
3       C   F  12.1  14.2     8.9
4       D   M  12.9  11.9    10.5</code></pre>
</div>
</div>
</section></section><section id="introduction-to-the-tidyverse" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="introduction-to-the-tidyverse">
<span class="header-section-number">3.5</span> Introduction to the <code>tidyverse</code>
</h2>
<p>it seems it is not super tidy in here and we need to improve that</p>
</section><section id="summarising-data-frames" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="summarising-data-frames">
<span class="header-section-number">3.6</span> Summarising data frames</h2>
<p>Now that we’re able to manipulate and extract data from our data frames our next task is to start exploring and getting to know our data. In this section we’ll start producing tables of useful summary statistics of the variables in our data frame and in the next two Chapters we’ll cover visualising our data with base R graphics and using the <code>ggplot2</code> package.</p>
<p>A really useful starting point is to produce some simple summary statistics of all of the variables in our <code>unicorns</code> data frame using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    p_care              food        block         height           weight      
 Length:96          low   :32   Min.   :1.0   Min.   : 1.200   Min.   : 5.790  
 Class :character   medium:32   1st Qu.:1.0   1st Qu.: 4.475   1st Qu.: 9.027  
 Mode  :character   high  :32   Median :1.5   Median : 6.450   Median :11.395  
                                Mean   :1.5   Mean   : 6.840   Mean   :12.155  
                                3rd Qu.:2.0   3rd Qu.: 9.025   3rd Qu.:14.537  
                                Max.   :2.0   Max.   :17.200   Max.   :23.890  
   mane_size       fluffyness       horn_rings    
 Min.   : 5.80   Min.   :  5.80   Min.   : 1.000  
 1st Qu.:11.07   1st Qu.: 39.05   1st Qu.: 4.000  
 Median :13.45   Median : 70.05   Median : 6.000  
 Mean   :14.05   Mean   : 79.78   Mean   : 7.062  
 3rd Qu.:16.45   3rd Qu.:113.28   3rd Qu.: 9.000  
 Max.   :49.20   Max.   :189.60   Max.   :17.000  </code></pre>
</div>
</div>
<p>For numeric variables (i.e. <code>height</code>, <code>weight</code> etc) the mean, minimum, maximum, median, first (lower) quartile and third (upper) quartile are presented. For factor variables (i.e. <code>care</code> and <code>food</code>) the number of observations in each of the factor levels is given. If a variable contains missing data then the number of <code>NA</code> values is also reported.</p>
<p>If we wanted to summarise a smaller subset of variables in our data frame we can use our indexing skills in combination with the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function. For example, to summarise only the <code>height</code>, <code>weight</code>, <code>mane_size</code> and <code>fluffyness</code> variables we can include the appropriate column indexes when using the <code>[ ]</code>. Notice we include all rows by not specifying a row index.</p>
<div class="cell">
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     height           weight         mane_size       fluffyness    
 Min.   : 1.200   Min.   : 5.790   Min.   : 5.80   Min.   :  5.80  
 1st Qu.: 4.475   1st Qu.: 9.027   1st Qu.:11.07   1st Qu.: 39.05  
 Median : 6.450   Median :11.395   Median :13.45   Median : 70.05  
 Mean   : 6.840   Mean   :12.155   Mean   :14.05   Mean   : 79.78  
 3rd Qu.: 9.025   3rd Qu.:14.537   3rd Qu.:16.45   3rd Qu.:113.28  
 Max.   :17.200   Max.   :23.890   Max.   :49.20   Max.   :189.60  </code></pre>
</div>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># or equivalently</span></span>
<span><span class="co"># summary(unicorns[, c("height", "weight", "mane_size", "fluffyness")])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And to summarise a single variable.</p>
<div class="cell">
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">mane_size</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   5.80   11.07   13.45   14.05   16.45   49.20 </code></pre>
</div>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># or equivalently</span></span>
<span><span class="co"># summary(unicorns[, 6])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you’ve seen above, the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function reports the number of observations in each level of our factor variables. Another useful function for generating tables of counts is the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function. The <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function can be used to build contingency tables of different combinations of factor levels. For example, to count the number of observations for each level of <code>food</code></p>
<div class="cell">
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   low medium   high 
    32     32     32 </code></pre>
</div>
</div>
<p>We can extend this further by producing a table of counts for each combination of <code>food</code> and <code>care</code> factor levels.</p>
<div class="cell">
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">p_care</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         care no_care
  low      16      16
  medium   16      16
  high     16      16</code></pre>
</div>
</div>
<p>A more flexible version of the <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> function is the <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> function. The <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> function uses a formula notation (<code>~</code>) to build contingency tables with the cross-classifying variables separated by a <code>+</code> symbol on the right hand side of the formula. <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> also has a useful <code>data =</code> argument so you don’t have to include the data frame name when specifying each variable.</p>
<div class="cell">
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        p_care
food     care no_care
  low      16      16
  medium   16      16
  high     16      16</code></pre>
</div>
</div>
<p>We can even build more complicated contingency tables using more variables. Note, in the example below the <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> function has quietly coerced our <code>block</code> variable to a factor.</p>
<div class="cell">
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , block = 1

        p_care
food     care no_care
  low       8       8
  medium    8       8
  high      8       8

, , block = 2

        p_care
food     care no_care
  low       8       8
  medium    8       8
  high      8       8</code></pre>
</div>
</div>
<p>And for a nicer formatted table we can nest the <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> function inside the <code><a href="https://rdrr.io/r/stats/ftable.html">ftable()</a></code> function to ‘flatten’ the table.</p>
<div class="cell">
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/ftable.html">ftable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span><span class="op">(</span><span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               block 1 2
food   p_care           
low    care          8 8
       no_care       8 8
medium care          8 8
       no_care       8 8
high   care          8 8
       no_care       8 8</code></pre>
</div>
</div>
<p>We can also summarise our data for each level of a factor variable. Let’s say we want to calculate the mean value of <code>height</code> for each of our <code>low</code>, <code>meadium</code> and <code>high</code> levels of <code>food</code>. To do this we will use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function and apply this to the <code>height</code> variable for each level of <code>food</code> using the <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     low   medium     high 
5.853125 7.012500 7.653125 </code></pre>
</div>
</div>
<p>The <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function is not just restricted to calculating mean values, you can use it to apply many of the functions that come with R or even functions you’ve written yourself (see <a href="05-programming.html" class="quarto-xref"><span>Chapter 5</span></a> for more details). For example, we can apply the <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function to calculate the standard deviation for each level of <code>food</code> or even the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">sd</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     low   medium     high 
2.828425 3.005345 3.483323 </code></pre>
</div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$low
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.800   3.600   5.550   5.853   8.000  12.300 

$medium
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.800   4.500   7.000   7.013   9.950  12.300 

$high
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.200   5.800   7.450   7.653   9.475  17.200 </code></pre>
</div>
</div>
<p>Note, if the variable you want to summarise contains missing values (<code>NA</code>) you will also need to include an argument specifying how you want the function to deal with the <code>NA</code> values. We saw an example if this in <a href="02-basics.html#sec-na-vals" class="quarto-xref"><span>Section 2.5.5</span></a> where the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function returned an <code>NA</code> when we had missing data. To include the <code>na.rm = TRUE</code> argument we simply add this as another argument when using <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     low   medium     high 
5.853125 7.012500 7.653125 </code></pre>
</div>
</div>
<p>We can also use <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> to apply functions to more than one factor. The only thing to remember is that the factors need to be supplied to the <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function in the form of a list using the <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> function. To calculate the mean <code>height</code> for each combination of <code>food</code> and <code>care</code> factor levels we can use the <code>list(unicorns$food, unicorns$p_care)</code> notation.</p>
<div class="cell">
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">height</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">p_care</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         care no_care
low    8.0375 3.66875
medium 9.1875 4.83750
high   9.6000 5.70625</code></pre>
</div>
</div>
<p>And if you get a little fed up with having to write <code>unicorns$</code> for every variable you can nest the <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function inside the <code><a href="https://rdrr.io/r/base/with.html">with()</a></code> function. The <code><a href="https://rdrr.io/r/base/with.html">with()</a></code> function allows R to evaluate an R expression with respect to a named data object (in this case <code>unicorns</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">unicorns</span>, <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">height</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">food</span>, <span class="va">p_care</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         care no_care
low    8.0375 3.66875
medium 9.1875 4.83750
high   9.6000 5.70625</code></pre>
</div>
</div>
<p>The <code><a href="https://rdrr.io/r/base/with.html">with()</a></code> function also works with many other functions and can save you alot of typing!</p>
<p>Another really useful function for summarising data is the <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code> function. The <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code> function works in a very similar way to <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> but is a bit more flexible.</p>
<p>For example, to calculate the mean of the variables <code>height</code>, <code>weight</code>, <code>mane_size</code> and <code>fluffyness</code> for each level of <code>food</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>food <span class="op">=</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    food   height    weight mane_size fluffyness
1    low 5.853125  8.652812  11.14375    45.1000
2 medium 7.012500 11.164062  13.83125    67.5625
3   high 7.653125 16.646875  17.18125   126.6875</code></pre>
</div>
</div>
<p>In the code above we have indexed the columns we want to summarise in the <code>unicorns</code> data frame using <code>unicorns[, 4:7]</code>. The <code>by =</code> argument specifies a list of factors (<code>list(food = unicorns$food)</code>) and the <code>FUN =</code> argument names the function to apply (<code>mean</code> in this example).</p>
<p>Similar to the <code><a href="https://rdrr.io/r/base/tapply.html">tapply()</a></code> function we can include more than one factor to apply a function to. Here we calculate the mean values for each combination of <code>food</code> and <code>care</code></p>
<div class="cell">
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  food <span class="op">=</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>,</span>
<span>  p_care <span class="op">=</span> <span class="va">unicorns</span><span class="op">$</span><span class="va">p_care</span></span>
<span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    food  p_care  height    weight mane_size fluffyness
1    low    care 8.03750  9.016250   9.96250   30.30625
2 medium    care 9.18750 11.011250  13.48750   40.59375
3   high    care 9.60000 16.689375  15.54375   98.05625
4    low no_care 3.66875  8.289375  12.32500   59.89375
5 medium no_care 4.83750 11.316875  14.17500   94.53125
6   high no_care 5.70625 16.604375  18.81875  155.31875</code></pre>
</div>
</div>
<p>We can also use the <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code> function in a different way by using the formula method (as we did with <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code>). On the left hand side of the formula (<code>~</code>) we specify the variable we want to apply the mean function on and to the right hand side our factors separated by a <code>+</code> symbol. The formula method also allows you to use the <code>data =</code> argument for convenience.</p>
<div class="cell">
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span>, FUN <span class="op">=</span> <span class="va">mean</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    food  p_care  height
1    low    care 8.03750
2 medium    care 9.18750
3   high    care 9.60000
4    low no_care 3.66875
5 medium no_care 4.83750
6   high no_care 5.70625</code></pre>
</div>
</div>
<p>One advantage of using the formula method is that we can also use the <code>subset =</code> argument to apply the function to subsets of the original data. For example, to calculate the mean <code>height</code> for each combination of the <code>food</code> and <code>care</code> levels but only for those unicorns that have less than 7 <code>horn_rings</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span>, FUN <span class="op">=</span> <span class="va">mean</span>, subset <span class="op">=</span> <span class="va">horn_rings</span> <span class="op">&lt;</span> <span class="fl">7</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    food  p_care   height
1    low    care 8.176923
2 medium    care 8.570000
3   high    care 7.900000
4    low no_care 3.533333
5 medium no_care 5.316667
6   high no_care 3.850000</code></pre>
</div>
</div>
<p>Or for only those unicorns in <code>block</code> 1.</p>
<div class="cell">
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">food</span> <span class="op">+</span> <span class="va">p_care</span>, FUN <span class="op">=</span> <span class="va">mean</span>, subset <span class="op">=</span> <span class="va">block</span> <span class="op">==</span> <span class="st">"1"</span>, data <span class="op">=</span> <span class="va">unicorns</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    food  p_care  height
1    low    care  8.7500
2 medium    care  9.5375
3   high    care 10.0375
4    low no_care  3.3250
5 medium no_care  5.2375
6   high no_care  5.9250</code></pre>
</div>
</div>
</section><section id="exporting-data" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="exporting-data">
<span class="header-section-number">3.7</span> Exporting data</h2>
<p>By now we hope you’re getting a feel for how powerful and useful R is for manipulating and summarising data (and we’ve only really scratched the surface). One of the great benefits of doing all your data wrangling in R is that you have a permanent record of all the things you’ve done to your data. Gone are the days of making undocumented changes in Excel or Calc! By treating your data as ‘read only’ and documenting all of your decisions in R you will have made great strides towards making your analysis more reproducible and transparent to others. It’s important to realise, however, that any changes you’ve made to your data frame in R will not change the original data file you imported into R (and that’s a good thing). Happily it’s straightforward to export data frames to external files in a wide variety of formats.</p>
<section id="export-functions" class="level3" data-number="3.7.1"><h3 data-number="3.7.1" class="anchored" data-anchor-id="export-functions">
<span class="header-section-number">3.7.1</span> Export functions</h3>
<p>The main workhorse function for exporting data frames is the <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> function. As with the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function, the <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> function is very flexible with lots of arguments to help customise it’s behaviour. As an example, let’s take our original <code>unicorns</code> data frame, do some useful stuff to it and then export these changes to an external file.</p>
<p>Similarly to <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code>, <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> has a series of function with format specific default values such as <code><a href="https://rdrr.io/r/utils/write.table.html">write.csv()</a></code> and <code>write.delim()</code> which use “,” and tabs as delimiters, respectively,and include column names by default.</p>
<p>Let’s order the rows in the data frame in ascending order of <code>height</code> within each level <code>food</code>. We will also apply a square root transformation on the number of horn rings variable (<code>horn_rings</code>) and a log<sub>10</sub> transformation on the <code>height</code> variable and save these as additional columns in our data frame (hopefully this will be somewhat familiar to you!).</p>
<div class="cell">
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unicorns_df2</span> <span class="op">&lt;-</span> <span class="va">unicorns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">unicorns</span><span class="op">$</span><span class="va">food</span>, <span class="va">unicorns</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">unicorns_df2</span><span class="op">$</span><span class="va">horn_rings_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">unicorns_df2</span><span class="op">$</span><span class="va">horn_rings</span><span class="op">)</span></span>
<span><span class="va">unicorns_df2</span><span class="op">$</span><span class="va">log10_height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">unicorns_df2</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">unicorns_df2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   96 obs. of  10 variables:
 $ p_care         : chr  "no_care" "no_care" "no_care" "no_care" ...
 $ food           : Factor w/ 3 levels "low","medium",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ block          : int  1 1 1 2 1 2 2 2 1 2 ...
 $ height         : num  1.8 2.2 2.3 2.4 3 3.1 3.2 3.3 3.7 3.7 ...
 $ weight         : num  6.01 9.97 7.28 9.1 9.93 8.74 7.45 8.92 7.03 8.1 ...
 $ mane_size      : num  17.6 9.6 13.8 14.5 12 16.1 14.1 11.6 7.9 10.5 ...
 $ fluffyness     : num  46.2 63.1 32.8 78.7 56.6 39.1 38.1 55.2 36.7 60.5 ...
 $ horn_rings     : int  4 2 6 8 6 3 4 6 5 6 ...
 $ horn_rings_sqrt: num  2 1.41 2.45 2.83 2.45 ...
 $ log10_height   : num  0.255 0.342 0.362 0.38 0.477 ...</code></pre>
</div>
</div>
<p>Now we can export our new data frame <code>unicorns_df2</code> using the <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> function. The first argument is the data frame you want to export (<code>unicorns_df2</code> in our example). We then give the filename (with file extension) and the file path in either single or double quotes using the <code>file =</code> argument. In this example we’re exporting the data frame to a file called <code>unicorns_transformed.csv</code> in the <code>data</code> directory. The <code>row.names = FALSE</code> argument stops R from including the row names in the first column of the file.</p>
<div class="cell">
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">unicorns_df2</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"data/unicorns_transformed.csv"</span>, </span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we saved the file as a comma delimited text file we could open this file in any text editor.</p>
<p>We can of course export our files in a variety of other formats.</p>
</section><section id="other-export-functions" class="level3" data-number="3.7.2"><h3 data-number="3.7.2" class="anchored" data-anchor-id="other-export-functions">
<span class="header-section-number">3.7.2</span> Other export functions</h3>
<p>As with importing data files into R, there are also many alternative functions for exporting data to external files beyond the <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> function. If you followed the ‘Other import functions’ <a href="#sec-import-other" class="quarto-xref"><span>Section 3.3.4</span></a> of this Chapter you will already have the required packages installed.</p>
<p>The <code>fwrite()</code> function from the <code>read.table</code> package is very efficient at exporting large data objects and is much faster than the <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> function. It’s also quite simple to use as it has most of the same arguments as <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code>. To export a tab delimited text file we just need to specify the data frame name, the output file name and file path and the separator between columns.</p>
<div class="cell">
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">read.table</span><span class="op">)</span></span>
<span><span class="fu">fwrite</span><span class="op">(</span><span class="va">unicorns_df2</span>, file <span class="op">=</span> <span class="st">"data/unicorns_04_12.txt"</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To export a csv delimited file it’s even easier as we don’t even need to include the <code>sep =</code> argument.</p>
<div class="cell">
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">read.table</span><span class="op">)</span></span>
<span><span class="fu">fwrite</span><span class="op">(</span><span class="va">unicorns_df2</span>, file <span class="op">=</span> <span class="st">"data/unicorns_04_12.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>readr</code> package also comes with two useful functions for quickly writing data to external files: the <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_tsv()</a></code> function for writing tab delimited files and the <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> function for saving comma separated values (csv) files.</p>
<div class="cell">
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_tsv</a></span><span class="op">(</span><span class="va">unicorns_df2</span>, path <span class="op">=</span> <span class="st">"data/unicorns_04_12.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">unicorns_df2</span>, path <span class="op">=</span> <span class="st">"data/unicorns_04_12.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--course website Links-->
<!--cran Links-->
<!--RStudio-->
<!--style guides-->
<!--Package Links-->
<!--Editors-->
<!--Bioconductor Links-->
<!--GitHub Links-->
<!--R markdown Links-->
<!--ggplot Links-->
<!--Basics links-->
<!--Data links-->
<!--Resource Links-->
<!--Misc Links-->


</section></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>For space and simplicity we are just showing the first and last five rows<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/biostats-uottawa\.github\.io\/Rway\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-basics.html" class="pagination-link" aria-label="Some R basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Some R basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-graphics_short.html" class="pagination-link" aria-label="Figures">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Figures</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="https://biostats-uottawa.github.io/people.html">Julien Martin</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostats-uottawa/Rway/edit/main/03-data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/biostats-uottawa/Rway/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>
